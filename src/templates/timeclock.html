<!-- src/templates/timeclock.html -->
<div id="timeclock-page" class="page-content">
    <!-- Header avec raccourcis clavier -->
    <div class="page-header">
        <h1>ğŸ’¼ Pointage</h1>
        <div class="shortcuts-info">
            <small>
                Raccourcis: Ctrl+I (ArrivÃ©e), Ctrl+O (Sortie), Ctrl+P (Pause), Ctrl+E (Export)
            </small>
        </div>
    </div>

    <!-- En-tÃªte avec statut actuel -->
    <div class="timeclock-header">
        <div class="current-status" id="current-status">
            <div class="status-icon" id="status-icon">â°</div>
            <div class="status-info">
                <h2 id="status-title">Non pointÃ©</h2>
                <p id="status-subtitle">Cliquez pour pointer votre arrivÃ©e</p>
                <div id="current-session-timer" class="session-timer" style="display: none;">
                    <span id="work-timer">00:00</span>
                    <span id="break-indicator" style="display: none;">ğŸ“± En pause</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Actions de pointage -->
    <div class="timeclock-actions">
        <!-- Pointage principal -->
        <div class="main-actions">
            <button id="clock-in-btn" class="action-btn primary" style="display: none;">
                <i class="icon">ğŸ•</i>
                <span>Pointer l'arrivÃ©e</span>
                <small>Ctrl+I</small>
            </button>
            
            <button id="clock-out-btn" class="action-btn danger" style="display: none;">
                <i class="icon">ğŸ </i>
                <span>Pointer la sortie</span>
                <small>Ctrl+O</small>
            </button>
            
            <button id="training-btn" class="action-btn secondary">
                <i class="icon">ğŸ“š</i>
                <span>En formation</span>
                <small>7h auto</small>
            </button>
        </div>

        <!-- Actions de pause -->
        <div class="break-actions" id="break-actions" style="display: none;">
            <button id="start-break-btn" class="action-btn secondary">
                <i class="icon">â¸ï¸</i>
                <span>Commencer une pause</span>
                <small>Ctrl+P</small>
            </button>
            
            <button id="end-break-btn" class="action-btn success" style="display: none;">
                <i class="icon">â–¶ï¸</i>
                <span>Terminer la pause</span>
                <small>Ctrl+P</small>
            </button>
        </div>

        <!-- Options distanciel -->
        <div class="remote-options">
            <label class="checkbox-container">
                <input type="checkbox" id="remote-work-checkbox">
                <span class="checkmark"></span>
                Travail Ã  distance
            </label>
            <button id="location-btn" class="icon-btn" title="Enregistrer la localisation actuelle">ğŸ“</button>
            <div id="location-status" class="location-status" style="display: none;">
                <span class="location-text">ğŸ“ Position enregistrÃ©e</span>
            </div>
        </div>
    </div>

    <!-- Zone de commentaires -->
    <div class="comment-section" id="comment-section" style="display: none;">
        <h3 id="comment-title">Commentaire</h3>
        <textarea 
            id="comment-input" 
            placeholder="Ajouter un commentaire (optionnel)..." 
            rows="3"
            maxlength="500"
        ></textarea>
        <div class="character-count">
            <span id="char-count">0</span>/500 caractÃ¨res
        </div>
        <div class="comment-actions">
            <button id="comment-cancel" class="btn secondary">
                Annuler <small>Ã‰chap</small>
            </button>
            <button id="comment-confirm" class="btn primary">
                Confirmer <small>EntrÃ©e</small>
            </button>
        </div>
    </div>

    <!-- Statistiques du jour -->
    <div class="daily-stats">
        <h3>ğŸ“Š Aujourd'hui</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ•’</div>
                <div class="stat-value" id="today-work-time">00:00</div>
                <div class="stat-label">Temps travaillÃ©</div>
                <div class="stat-target">Objectif: 8h00</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â¸ï¸</div>
                <div class="stat-value" id="today-break-time">00:00</div>
                <div class="stat-label">Temps pause</div>
                <div class="stat-target">RecommandÃ©: 1h00</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â°</div>
                <div class="stat-value" id="today-overtime">00:00</div>
                <div class="stat-label">Heures sup.</div>
                <div class="stat-progress" id="overtime-progress"></div>
            </div>
        </div>
    </div>

    <!-- Historique -->
    <div class="timeclock-history">
        <div class="history-header">
            <h3>ğŸ“ˆ Historique des pointages</h3>
            <div class="history-controls">
                <select id="period-select">
                    <option value="week">Cette semaine</option>
                    <option value="month">Ce mois</option>
                    <option value="quarter">Ce trimestre</option>
                    <option value="custom">PÃ©riode personnalisÃ©e</option>
                </select>
                <button id="refresh-btn" class="btn secondary" title="Actualiser">
                    ğŸ”„
                </button>
                <button id="export-btn" class="btn secondary">
                    ğŸ“¥ Exporter <small>Ctrl+E</small>
                </button>
            </div>
        </div>

        <!-- Filtres personnalisÃ©s -->
        <div class="custom-period" id="custom-period" style="display: none;">
            <div class="date-inputs">
                <label>Du:</label>
                <input type="date" id="start-date">
                <label>Au:</label>
                <input type="date" id="end-date">
                <button id="apply-filter" class="btn primary">Appliquer</button>
                <button id="reset-filter" class="btn secondary">RÃ©initialiser</button>
            </div>
        </div>

        <!-- RÃ©sumÃ© de la pÃ©riode -->
        <div class="period-summary">
            <div class="summary-header">
                <h4>ğŸ“‹ RÃ©sumÃ© de la pÃ©riode</h4>
                <div class="summary-actions">
                    <button id="summary-details" class="btn-link">Voir dÃ©tails</button>
                </div>
            </div>
            <div class="summary-stats">
                <div class="summary-item">
                    <span class="summary-icon">â±ï¸</span>
                    <span class="summary-label">Temps total:</span>
                    <span class="summary-value" id="period-total-time">00:00</span>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">ğŸ“…</span>
                    <span class="summary-label">Jours travaillÃ©s:</span>
                    <span class="summary-value" id="period-days-worked">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">â°</span>
                    <span class="summary-label">Heures sup.:</span>
                    <span class="summary-value" id="period-overtime">00:00</span>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">ğŸ“š</span>
                    <span class="summary-label">Jours formation:</span>
                    <span class="summary-value" id="period-training-days">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">ğŸ“±</span>
                    <span class="summary-label">Jours distanciel:</span>
                    <span class="summary-value" id="period-remote-days">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-icon">ğŸ•</span>
                    <span class="summary-label">Retards:</span>
                    <span class="summary-value" id="period-late-count">0</span>
                </div>
            </div>
        </div>

        <!-- Filtres et recherche -->
        <div class="entries-filters">
            <div class="filter-group">
                <input 
                    type="text" 
                    id="search-entries" 
                    placeholder="Rechercher dans les commentaires..."
                    class="search-input"
                >
                <button id="clear-search" class="btn-icon" title="Effacer">âŒ</button>
            </div>
            <div class="filter-toggles">
                <label class="toggle-filter">
                    <input type="checkbox" id="filter-remote" checked>
                    <span>ğŸ“± Distanciel</span>
                </label>
                <label class="toggle-filter">
                    <input type="checkbox" id="filter-training" checked>
                    <span>ğŸ“š Formation</span>
                </label>
                <label class="toggle-filter">
                    <input type="checkbox" id="filter-late" checked>
                    <span>â° Retards</span>
                </label>
            </div>
        </div>

        <!-- Liste des entrÃ©es -->
        <div class="entries-container">
            <div class="entries-loading" id="entries-loading" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Chargement des donnÃ©es...</p>
            </div>
            <div class="entries-list" id="entries-list">
                <!-- Les entrÃ©es seront chargÃ©es ici -->
            </div>
            <div class="entries-empty" id="entries-empty" style="display: none;">
                <div class="empty-icon">ğŸ“­</div>
                <p>Aucun pointage trouvÃ© pour cette pÃ©riode</p>
                <button id="create-first-entry" class="btn primary">Faire mon premier pointage</button>
            </div>
        </div>

        <!-- Pagination -->
        <div class="entries-pagination" id="entries-pagination" style="display: none;">
            <button id="prev-page" class="btn secondary">â† PrÃ©cÃ©dent</button>
            <span id="page-info">Page 1 sur 1</span>
            <button id="next-page" class="btn secondary">Suivant â†’</button>
        </div>
    </div>

    <!-- Modal d'export -->
    <div id="export-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“¥ Exporter les donnÃ©es</h3>
                <button class="modal-close" id="export-modal-close">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="form-group">
                        <label>Format d'export:</label>
                        <select id="export-format">
                            <option value="csv">ğŸ“Š CSV (Excel, Calc)</option>
                            <option value="json">ğŸ’¾ JSON (DonnÃ©es brutes)</option>
                            <option value="pdf">ğŸ“„ PDF (Rapport)</option>
                        </select>
                    </div>
                </div>
                <div class="export-period">
                    <div class="form-group">
                        <label>PÃ©riode Ã  exporter:</label>
                        <div class="date-range">
                            <input type="date" id="export-start-date">
                            <span>Ã </span>
                            <input type="date" id="export-end-date">
                        </div>
                    </div>
                </div>
                <div class="export-options-advanced">
                    <h4>Options avancÃ©es</h4>
                    <label class="checkbox-container">
                        <input type="checkbox" id="export-include-breaks" checked>
                        <span>Inclure le dÃ©tail des pauses</span>
                    </label>
                    <label class="checkbox-container">
                        <input type="checkbox" id="export-include-comments" checked>
                        <span>Inclure les commentaires</span>
                    </label>
                    <label class="checkbox-container">
                        <input type="checkbox" id="export-include-location">
                        <span>Inclure les donnÃ©es de localisation</span>
                    </label>
                </div>
                <div class="export-preview">
                    <h4>AperÃ§u de l'export</h4>
                    <div id="export-summary">
                        <p><strong>PÃ©riode:</strong> <span id="export-period-text">-</span></p>
                        <p><strong>Nombre d'entrÃ©es:</strong> <span id="export-entries-count">0</span></p>
                        <p><strong>Taille estimÃ©e:</strong> <span id="export-size-estimate">-</span></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="export-cancel" class="btn secondary">Annuler</button>
                <button id="export-download" class="btn primary">
                    <span class="btn-text">TÃ©lÃ©charger</span>
                    <span class="btn-loading" style="display: none;">â³ GÃ©nÃ©ration...</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation admin -->
    <div id="admin-edit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>âœï¸ Modifier le pointage (Admin)</h3>
                <button class="modal-close" id="admin-modal-close">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="admin-warning">
                    âš ï¸ Cette action est rÃ©servÃ©e aux administrateurs et sera tracÃ©e dans les logs.
                </div>
                <div class="form-group">
                    <label for="admin-clock-in">Heure d'arrivÃ©e:</label>
                    <input type="datetime-local" id="admin-clock-in" required>
                </div>
                <div class="form-group">
                    <label for="admin-clock-out">Heure de sortie:</label>
                    <input type="datetime-local" id="admin-clock-out">
                    <small>Laisser vide si le pointage est toujours en cours</small>
                </div>
                <div class="form-group">
                    <label for="admin-comment">Motif de la modification: *</label>
                    <textarea 
                        id="admin-comment" 
                        rows="3" 
                        placeholder="Expliquez la raison de cette modification..."
                        required
                        maxlength="500"
                    ></textarea>
                    <small>Ce commentaire sera visible dans l'historique des modifications</small>
                </div>
            </div>
            <div class="modal-footer">
                <button id="admin-cancel" class="btn secondary">Annuler</button>
                <button id="admin-save" class="btn danger">
                    ğŸ’¾ Sauvegarder les modifications
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de dÃ©tails d'une entrÃ©e -->
    <div id="entry-details-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="entry-details-title">ğŸ“‹ DÃ©tails du pointage</h3>
                <button class="modal-close" id="entry-details-close">Ã—</button>
            </div>
            <div class="modal-body" id="entry-details-content">
                <!-- Contenu gÃ©nÃ©rÃ© dynamiquement -->
            </div>
            <div class="modal-footer">
                <button id="entry-details-close-btn" class="btn primary">Fermer</button>
            </div>
        </div>
    </div>
</div>

<!-- Template pour les entrÃ©es d'historique -->
<template id="entry-template">
    <div class="entry-item" data-entry-id="">
        <div class="entry-header">
            <div class="entry-date-section">
                <div class="entry-date"></div>
                <div class="entry-day"></div>
            </div>
            <div class="entry-badges">
                <span class="badge remote" style="display: none;">ğŸ“± Distanciel</span>
                <span class="badge training" style="display: none;">ğŸ“š Formation</span>
                <span class="badge late" style="display: none;">â° Retard</span>
                <span class="badge modified" style="display: none;">âœï¸ ModifiÃ©</span>
            </div>
            <div class="entry-summary">
                <span class="entry-times">
                    <span class="clock-in-time"></span> â†’ <span class="clock-out-time"></span>
                </span>
                <span class="entry-duration"></span>
            </div>
            <div class="entry-actions">
                <button class="details-btn" title="Voir les dÃ©tails">ğŸ‘ï¸</button>
                <button class="admin-edit-btn" style="display: none;" title="Modifier (Admin)">âœï¸</button>
            </div>
        </div>
        <div class="entry-details" style="display: none;">
            <div class="details-grid">
                <div class="detail-item">
                    <strong>ğŸ• ArrivÃ©e:</strong>
                    <span class="clock-in-detail"></span>
                </div>
                <div class="detail-item">
                    <strong>ğŸ  Sortie:</strong>
                    <span class="clock-out-detail"></span>
                </div>
                <div class="detail-item">
                    <strong>â±ï¸ TravaillÃ©:</strong>
                    <span class="work-duration"></span>
                </div>
                <div class="detail-item">
                    <strong>â¸ï¸ Pauses:</strong>
                    <span class="break-duration"></span>
                </div>
            </div>
            <div class="comments-section" style="display: none;">
                <div class="comment-in"></div>
                <div class="comment-out"></div>
            </div>
            <div class="breaks-section" style="display: none;">
                <strong>ğŸ“‹ DÃ©tail des pauses:</strong>
                <div class="breaks-list"></div>
            </div>
            <div class="admin-info" style="display: none;">
                <div class="admin-comment"></div>
                <div class="admin-modified-by"></div>
            </div>
        </div>
    </div>
</template>

<!-- Template pour les pauses -->
<template id="break-template">
    <div class="break-item">
        <span class="break-time"></span>
        <span class="break-duration"></span>
        <span class="break-reason"></span>
    </div>
</template>
